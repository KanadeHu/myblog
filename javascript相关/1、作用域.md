## 关于javascript作用域详解

>  javascript作用域在我们实际工作中息息相关，同时在我们面试求职过程也不可避免成为了八股文级别的面试题，那么我们就有必要了解一下javascript作用域相关的内容了

### 1、关于作用域的工作模型
---

+ **词法作用域**：词法作用域是由你在写代码时将变量和块作用域写在哪里来决定的，因此当词法分析器处理代码时会保持作用域不变（部分情况会有变化）；（javascript所采用的是词法作用域）

+ **动态作用域**：

### 2、词法作用域与欺骗词法
---
为了方便我们理解词法作用域，我们简单的将作用域想象成为一个气泡，如下图所示:

![词法作用域演示](./images/1.png)

我们可以通过上面的气泡图结构直接香菇的书写位置信息看出作用域的范围，同样引擎可以通过位置关系去查找标识符的位置，作用域查找是逐级向外或者说向上进行，直到遇见第一个匹配的标识符为止

#### （1）关于eval(...) 欺骗词法作用域

首先我们看下面一段例子
```javascript
function foo(str, a) {
    eval( str ); // 欺骗
    console.log( a, b 
);}
var b = 2;
foo( "var b = 3;", 1 ); // 1, 3
```
eval()会在作用域内新生成一个`a = 3`的局部变量，按照词法作用域逐级寻找的办法，输出内容就是1,3
当然在严格模式下，eval()有自己的词法作用域，不会对其他的作用域产生负面影响，我们试着运行一下下面的例子
```javascript
function foo(str, b) {
    "use strict"
    eval(str) // 1 2
    console.log(a) // ReferenceError: a is not defined
}
foo('var a = 1; console.log(a, b)', 2)
```
在严格模式下，我们可以吧eval()作为一个独立的“气泡”来去看待，eval()内部找不到的变量也会遵循逐级向上查找；

#### (2)关于with
我们先用下面一个例子来看with的基本用法
```javascript
// obj.a = 1
// obj.b = 2
// 等价于
// width(obj) {
//     a = 1,
//     b = 3
// }


function foo(obj) {
    with (obj) {
        a = 2;
    }
}
var o1 = {a: 3}

foo(o1)
console.log(o1.a, a) // 2, 2
```
在实际中with通常用作改善对象赋值操作，但是with会把变量值